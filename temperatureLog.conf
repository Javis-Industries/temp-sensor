#!/bin/sh
python3 dhtpython.pypi@mtus-sr-p-rpi-01:~/tempSensor $ cat telegraf.sh 
#!/bin/sh
telegraf --config temperatureLog2.confpi@mtus-sr-p-rpi-01:~/tempSensor $ cat temperatureLog2.conf 
[agent]
   # Batch size of values that Telegraf sends to output plugins.
   metric_batch_size = 1000
   # Default data collection interval for inputs.
   interval = "30s"
   # Added degree of randomness in the collection interval.
   collection_jitter = "5s"
   # Send output every 5 seconds
   flush_interval = "5s"
   # Buffer size for failed writes.
   metric_buffer_limit = 10000
   # Run in quiet mode, i.e don't display anything on the console.
   quiet = true

[[inputs.tail]]
   # Files to read
   files = ["/home/pi/tempSensor/temperature.log"]

    # Only send these fields to the output plugins
   fieldpass = ["temperature", "humidity", "timestamp"]
   tagexclude = ["path"]

   # Read the file from beginning on the telegraf startup
   from_beginning = true
   grok_patterns = ["%{TEMPERATURE_HUMIDITY_PATTERN}"]

   # For parsing logstash-style "grok" patterns
   grok_custom_pattern_files = []
   grok_custom_patterns = '''
      TEMPERATURE_HUMIDITY_PATTERN %{NUMBER:timestamp:ts-epoch} Temp=%{NUMBER:temperature:float} %{GREEDYDATA}=%{NUMBER:humidity:float}%{GREEDYDATA}
   '''
   grok_timezone = "America/Chicago"
   data_format = "grok"

#[[outputs.file]]
#   files=["stdout"]

[[outputs.influxdb]]
   ## The full HTTP or UDP URL for your InfluxDB instance.
   urls = ["http://127.0.0.1:8086"] # required

   ## The target database for metrics (telegraf will create it if not exists).
   database = "temperature" # required

   ## Name of existing retention policy to write to.  Empty string writes to
   ## the default retention policy.
   retention_policy = ""
   ## Write consistency (clusters only), can be: "any", "one", "quorum", "all"
   write_consistency = "any"

   ## Write timeout (for the InfluxDB client), formatted as a string.
   ## If not provided, will default to 5s. 0s means no timeout (not recommended).
   timeout = "10s"
   # username = "telegraf"
   # password = "metricsmetricsmetricsmetrics"
   ## Set the user agent for HTTP POSTs (can be useful for log differentiation)
   # user_agent = "telegraf"
   ## Set UDP payload size, defaults to InfluxDB UDP Client default (512 bytes)
   # udp_payload = 512